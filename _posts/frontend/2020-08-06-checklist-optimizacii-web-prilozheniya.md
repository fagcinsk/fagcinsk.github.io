---
layout: post
categories: frontend
title: Чеклист оптимиации веб-приложения
description: Пополняемый список ключевых моментов для оптимизации сайтов и веб-приложений
---

Оставлю здесь список ключевых мест, подлежащих оптимизации.
Будет полезно мне при выкатывании очередного проекта в продакшен,
а так же всем заинтересованным в отзывчивых веб-приложениях и веб-интерфейсах.

## Серверная часть

Я привык к nginx, его удобно настраивать, быстро достигая желаемого результата.
На серверной стороне и на бэкэнде в целом улучшается параметр Time To First Byte (TTFB).
Этот параметр показывает время от начала запроса до получения первого байта данных от сервера.

На начальном этапе время тратится на:

- задержку сети
- время на получение IP от DNS сервера
- время на установку соединения

TTFB складывается из:

- время на передачу пакета данных запроса
- время на обработку запроса веб-приложением
- время на генерацию ответа (добавление заголовков, сжатие)

Для уменьшения времени необходимо следующее:

- обеспечить высокую пропускную способность сети
- предусмотреть балансировку нагрузки
- использовать CDN для доставки контента от территориально ближайшего сервера или сервера с меньшим пингом
- оптимизировать веб-сервер для обработки большого количества запросов
  - облегчить правила фаервола
  - минимизировать количество прокси
  - настроить буферы
  - настроить кеширование статики
- оптимизировать само веб-приложение (далее)
- настроить сжатие (оптимально brotli со степенью компрессии около 5, значение выше не даёт значительного уменьшения)
- уменьшить количество передаваемых заголовков в ответе
- использование протокола http2 для обработки запросов в одном соединении

## Оптимизация веб-приложения

Веб приложение обычно состоит из бэкэнда и фронтенда.

### Бэкэнд

На бэкэнде (так же влияет на показатель TTFB) оптимизация сводится к следующему:

  - стараться использовать статику где это возможно
  - настроить кеширование и буферизацию запросов к БД
  - настроить кеширование страниц
  - настроить кеширование скриптов прилжения (opcache, apc(u) cache, ...)
  - оптимизировать запросы к БД
  - минимизировать объём передаваемых данных от api

### Фронтенд
  
На фронтенде показателей больше:

- First Contentful Paint (FCP) &mdash; время до первой отрисовки
- First Meaningful Paint (FMP) &mdash; время до отрисовки основной части контента
- First Input Delay (FID) &mdash; время отклика на событие, генерированное пользователем
- Total Blocking Time (TBT) &mdash; суммарное время задач длительностью более 50мс
- Time To Interactive (TTI) &mdash; время до момента возможности работы с интерактивными элементами страницы

Оптимизируется всё это следующим и шагами:

- минификация JS/CSS/HTML
- вынесение критичных стилей в head > style
- разделение стилей на куски и их дозагрузка после первого экрана
- перенос, либо отложенная (async, defer) загрузка скриптов JavaScript
- ленивая загрузка веб-шрифтов, в идеале использование системных - Web safe шрифтов
- ленивая загрузка изображений
- сжатие изображений по размеру в пикселях
- использование векторной графики или CSS3 где это возможно
- сжатие изображений по качеству
- использование современных способов сжатия (webp)
- использование requestAnimationFrame для анимаций
- использование requestIdleFrame для длительных задач
- использование WebWorkers для сложных длительных задач
- использование ServiceWorkers для обеспечения кеширования запросов
- уменьшение вложенности DOM дерева
- упрощение селекторов CSS (по методологии БЭМ)
- использование ленивой загрузки данных (Infinite Scrolling)

Список оптимизируемого будет пополняться, на данный момент это всё, что вспомнил. =)
